import { Avatar, Button, Card, CardActions, CardContent, Container, Stack, Typography } from '@mui/material'
import { useMetaMask } from 'metamask-react'
import type { NextPage } from 'next'
import Head from 'next/head'

const assets_init: JSX.Element[] = [];
const assets_connected: JSX.Element[] = [
  <Card sx={{ display: 'flex', flexDirection: 'row' }}>
    <Avatar>ETH</Avatar>
    <CardContent sx={{ display: 'flex', flexDirection: 'row' }}>
      <Typography>ETH</Typography>
      <Typography>Ethereum</Typography>
      <Typography>3000 $</Typography>
    </CardContent>
  </Card>,
  <Card sx={{ display: 'flex', flexDirection: 'row' }}>
    <Avatar>ETH</Avatar>
    <CardContent sx={{ display: 'flex', flexDirection: 'row' }}>
      <Typography>ETH</Typography>
      <Typography>Ethereum</Typography>
      <Typography>3000 $</Typography>
    </CardContent>
  </Card>,
];

const Home: NextPage = () => {
  const { status, connect, account, chainId, ethereum } = useMetaMask();

  let assets = assets_init;

  const connectMetamask = async (): Promise<void> => {
    const strings = await connect();
    assets = assets_connected;
  };

  return (
    <Container>
      <Head>
        <title>Create Next App</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>

      {
        {
          'initializing': <Card sx={{ maxWidth: 360 }}>
            <CardContent>
              <Typography gutterBottom variant='h5' component='div'>{status}</Typography>
              <Typography variant='body2' color='text.secondary'>
                Synchronization with MetaMask ongoing...
              </Typography>
            </CardContent>
          </Card>,
          'unavailable': <Card sx={{ maxWidth: 360 }}>
            <CardContent>
              <Typography gutterBottom variant='h5' component='div'>{status}</Typography>
              <Typography variant='body2' color='text.secondary'>
                MetaMask not available :(
              </Typography>
            </CardContent>
          </Card>,
          'notConnected': <Card sx={{ maxWidth: 360 }}>
            <CardContent>
              <Typography gutterBottom variant='h5' component='div'>{status}</Typography>
              <Typography variant='body2' color='text.secondary'>
                Not connected
              </Typography>
            </CardContent>
            <CardActions>
              <Button onClick={connectMetamask}>Connect to MetaMask</Button>
            </CardActions>
          </Card>,
          'connecting': <Card sx={{ maxWidth: 360 }}>
            <CardContent>
              <Typography gutterBottom variant='h5' component='div'>{status}</Typography>
              <Typography variant='body2' color='text.secondary'>
                Connecting...
              </Typography>
            </CardContent>
          </Card>,
          'connected': <Card sx={{ maxWidth: 360 }}>
            <CardContent>
              <Typography gutterBottom variant='h5' component='div'>{status}</Typography>
              <Typography variant='body2' color='text.secondary'>
                Connected account {account} on chain ID {chainId}
              </Typography>
            </CardContent>
          </Card>,
        }[status]
      }

      <Stack>
        {assets}
      </Stack>
    </Container>
  )
}

export default Home
